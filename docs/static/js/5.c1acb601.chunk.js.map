{"version":3,"sources":["components/light/Icon.js","api/lightUrls.js","api/urls.js","api/common.js","utils/tools.js","api/index.js","api/lightApi.js","views/light/login/Login.js"],"names":["Icon","props","name","className","onClick","urls","light","login","list","myBooks","detail","axios","defaults","baseURL","interceptors","request","use","config","headers","token","localStorage","getItem","isNeedExtraData","extraData","userId","method","params","data","err","Promise","reject","response","res","code","message","warning","timer","common","a","Api","url","id","Login","useState","username","setUsername","password","setPassword","handleLogin","trim","setTimeout","store","dispatch","type","key","value","showLoading","then","history","push","clearTimeout","info","onChange","e","target","placeholder","autoFocus","onKeyUp","keyCode","handleEnter"],"mappings":"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","file":"static/js/5.c1acb601.chunk.js","sourcesContent":["import React from \"react\"\r\n\r\nexport default function Icon(props) {\r\n  let { name, className } = props\r\n  return (\r\n    <span\r\n      className={`icon iconfont icon-${name} ${className ? className : \"\"}`}\r\n      onClick={props.onClick}\r\n    ></span>\r\n  )\r\n}\r\n","const urls = {\r\n  login: '/api/login',\r\n  list: '/api/list',\r\n  myBooks: '/api/my_books',\r\n  detail: '/api/detail/'\r\n}\r\n\r\nexport default urls","import light from \"./lightUrls\"\r\n\r\nconst urls = {\r\n  light,\r\n}\r\n\r\nexport default urls\r\n","import axios from \"axios\"\r\nimport { message } from 'antd'\r\n\r\nif (process.env.NODE_ENV === \"development\") {\r\n  axios.defaults.baseURL = 'http://localhost:81' //\"http://localhost:81\"\r\n} else {\r\n  axios.defaults.baseURL = 'https://efficacious-tiny-infinity.glitch.me'\r\n}\r\n\r\naxios.interceptors.request.use(\r\n  (config) => {\r\n    config.headers.token = localStorage.getItem(\"token\") || \"\"\r\n\r\n    if (config.isNeedExtraData !== false) {\r\n      let extraData = { userId: 1 }\r\n      if (config.method === \"get\") {\r\n        config.params = { ...extraData, ...config.data }\r\n      } else {\r\n        config.data = { ...extraData, ...config.data }\r\n      }\r\n    }\r\n    return config\r\n  },\r\n  (err) => {\r\n    return Promise.reject(err)\r\n  }\r\n)\r\n\r\naxios.interceptors.response.use(\r\n  (res) => {\r\n    if (res.data.code === 200) {\r\n      return res.data\r\n    } else if (res.data.code === 400) {\r\n      message.warning(res.data.message)\r\n      return res.data\r\n    } else {\r\n      return Promise.reject(res)\r\n    }\r\n  }\r\n)\r\n\r\nexport const common = async (config) => {\r\n  let res = await axios(config)\r\n  return res\r\n}\r\n","import store from '../store'\r\n\r\nlet timer\r\n\r\nconst showLoading = (delay = 0) => {\r\n  timer = setTimeout(() => {\r\n    store.dispatch({\r\n      type: 'SET_LIGHT_STATE',\r\n      key: ['isLoading'],\r\n      value: true,\r\n    })\r\n  }, delay)\r\n}\r\n\r\nconst hideLoading = () => {\r\n  clearTimeout(timer)\r\n  store.dispatch({\r\n    type: 'SET_LIGHT_STATE',\r\n    key: ['isLoading'],\r\n    value: false,\r\n  })\r\n}\r\n\r\nexport {\r\n  showLoading,\r\n  hideLoading,\r\n} ","import light from './lightApi'\r\n\r\nconst Api = {\r\n  light\r\n}\r\n\r\nexport default Api\r\n\r\n\r\n\r\n","import urls from './urls'\r\nimport { common } from './common'\r\n\r\nconst Api = {\r\n  login: (data) => common({ url: urls.light.login, data, method: 'post' }),\r\n  list: () => common({ url: urls.light.list }),\r\n  myBooks: (data, method) => common({ url: urls.light.myBooks, data, method }),\r\n  detail: (id) => common({ url: urls.light.detail + id })\r\n}\r\n\r\nexport default Api","import React, { useState } from 'react'\r\nimport { Button, Input, message } from 'antd'\r\nimport Icon from '../../../components/light/Icon'\r\nimport Api from '../../../api'\r\nimport { showLoading, hideLoading } from '../../../utils/tools'\r\n\r\nexport default function Login(props) {\r\n  const [username, setUsername] = useState('admin')\r\n  const [password, setPassword] = useState('123456')\r\n\r\n  const handleEnter = (e) => {\r\n    if (e.keyCode === 13) {\r\n      handleLogin()\r\n    }\r\n  }\r\n\r\n  const handleLogin = () => {\r\n    if (username.trim() === '') {\r\n      message.info('用户名不能为空')\r\n      return\r\n    } else if (password.trim() === '') {\r\n      message.info('密码不能为空')\r\n      return\r\n    }\r\n    showLoading()\r\n    Api.light.login({ username, password }).then(res => {\r\n      if (res.code === 200) {\r\n        props.history.push('/light/index')\r\n        hideLoading()\r\n      }\r\n    })\r\n  }\r\n\r\n  return (\r\n    <div className=\"m-wrap\">\r\n      <div className=\"m-login\">\r\n        <div className=\"m-login-row\">\r\n          <Icon name=\"username\" className=\"m-login-icon\"></Icon>\r\n          <Input\r\n            value={username}\r\n            onChange={(e) => setUsername(e.target.value)}\r\n            placeholder=\"用户名\"\r\n            className=\"m-login-input\"\r\n            autoFocus\r\n          />\r\n        </div>\r\n        <div className=\"m-login-row\">\r\n          <Icon name=\"password\" className=\"m-login-icon\"></Icon>\r\n          <Input\r\n            value={password}\r\n            type=\"password\"\r\n            onChange={(e) => setPassword(e.target.value)}\r\n            onKeyUp={(e) => handleEnter(e)}\r\n            placeholder=\"密码\"\r\n            className=\"m-login-input\"\r\n          />\r\n        </div>\r\n        <div className=\"m-login-btn-wrap\">\r\n          <Button onClick={() => handleLogin()}>登录</Button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"sourceRoot":""}